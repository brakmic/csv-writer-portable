var CsvWriter;(()=>{var t={836:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CsvStringifierFactory=void 0;var i=r(792),n=r(99),o=r(362),c=function(){function t(){}return t.prototype.createArrayCsvStringifier=function(t){var e=(0,n.createFieldStringifier)(t.fieldDelimiter,t.alwaysQuote,t.quoteEmptyFields,t.filterFunction?t.filterFunction:function(t){return t});return new i.ArrayCsvStringifier(e,t.recordDelimiter,t.header)},t.prototype.createObjectCsvStringifier=function(t){var e=(0,n.createFieldStringifier)(t.fieldDelimiter,t.alwaysQuote,t.quoteEmptyFields,t.filterFunction?t.filterFunction:function(t){return t});return new o.ObjectCsvStringifier(e,t.header,t.recordDelimiter,t.headerIdDelimiter)},t}();e.CsvStringifierFactory=c},291:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CsvStringifier=void 0;var r=["\n","\r\n"],i=function(){function t(t,e){void 0===e&&(e="\n"),this.fieldStringifier=t,this.recordDelimiter=e,function(t){if(-1===r.indexOf(t))throw new Error("Invalid record delimiter `".concat(t,"` is specified"))}(e)}return t.prototype.getHeaderString=function(){var t=this.getHeaderRecord();return t?this.joinRecords([this.getCsvLine(t)]):null},t.prototype.stringifyRecords=function(t){var e=this,r=Array.from(t,(function(t){return e.getCsvLine(e.getRecordAsArray(t))}));return this.joinRecords(r)},t.prototype.getCsvLine=function(t){var e=this;return t.map((function(t){return e.fieldStringifier.stringify(t)})).join(this.fieldStringifier.fieldDelimiter)},t.prototype.joinRecords=function(t){return t.join(this.recordDelimiter)+this.recordDelimiter},t}();e.CsvStringifier=i},792:function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.ArrayCsvStringifier=void 0;var o=function(t){function e(e,r,i){var n=t.call(this,e,r)||this;return n.header=i,n}return n(e,t),e.prototype.getHeaderRecord=function(){return this.header},e.prototype.getRecordAsArray=function(t){return t},e}(r(291).CsvStringifier);e.ArrayCsvStringifier=o},362:function(t,e,r){"use strict";var i,n=this&&this.__extends||(i=function(t,e){return i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},i(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function r(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)});Object.defineProperty(e,"__esModule",{value:!0}),e.ObjectCsvStringifier=void 0;var o=r(291),c=r(218),u=function(t){function e(e,r,i,n){var o=t.call(this,e,i)||this;return o.header=r,o.headerIdDelimiter=n,o}return n(e,t),e.prototype.getHeaderRecord=function(){return this.isObjectHeader?this.header.map((function(t){return t.title})):null},e.prototype.getRecordAsArray=function(t){var e=this;return this.fieldIds.map((function(r){return e.getNestedValue(t,r)}))},e.prototype.getNestedValue=function(t,e){return this.headerIdDelimiter?e.split(this.headerIdDelimiter).reduce((function(t,e){return(t||{})[e]}),t):t[e]},Object.defineProperty(e.prototype,"fieldIds",{get:function(){return this.isObjectHeader?this.header.map((function(t){return t.id})):this.header},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isObjectHeader",{get:function(){return(0,c.isObject)(this.header&&this.header[0])},enumerable:!1,configurable:!0}),e}(o.CsvStringifier);e.ObjectCsvStringifier=u},49:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CsvWriterFactory=void 0;var i=r(854),n=function(){function t(t){this.csvStringifierFactory=t}return t.prototype.createArrayCsvWriter=function(t){var e=this.csvStringifierFactory.createArrayCsvStringifier({header:t.header,fieldDelimiter:t.fieldDelimiter,recordDelimiter:t.recordDelimiter,alwaysQuote:t.alwaysQuote,quoteEmptyFields:t.quoteEmptyFields,filterFunction:t.filterFunction});return new i.CsvWriter(e,t.path,t.encoding,t.append)},t.prototype.createObjectCsvWriter=function(t){var e=this.csvStringifierFactory.createObjectCsvStringifier({header:t.header,fieldDelimiter:t.fieldDelimiter,recordDelimiter:t.recordDelimiter,headerIdDelimiter:t.headerIdDelimiter,alwaysQuote:t.alwaysQuote,quoteEmptyFields:t.quoteEmptyFields,filterFunction:t.filterFunction});return new i.CsvWriter(e,t.path,t.encoding,t.append)},t}();e.CsvWriterFactory=n},854:function(t,e,r){"use strict";var i=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))((function(n,o){function c(t){try{s(i.next(t))}catch(t){o(t)}}function u(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(c,u)}s((i=i.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var r,i,n,o,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(s){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(c=0)),c;)try{if(r=1,i&&(n=2&u[0]?i.return:u[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,u[1])).done)return n;switch(i=0,n&&(u=[2&u[0],n.value]),u[0]){case 0:case 1:n=u;break;case 4:return c.label++,{value:u[1],done:!1};case 5:c.label++,i=u[1],u=[0];continue;case 7:u=c.ops.pop(),c.trys.pop();continue;default:if(!((n=(n=c.trys).length>0&&n[n.length-1])||6!==u[0]&&2!==u[0])){c=0;continue}if(3===u[0]&&(!n||u[1]>n[0]&&u[1]<n[3])){c.label=u[1];break}if(6===u[0]&&c.label<n[1]){c.label=n[1],n=u;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(u);break}n[2]&&c.ops.pop(),c.trys.pop();continue}u=e.call(t,c)}catch(t){u=[6,t],i=0}finally{r=n=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.CsvWriter=void 0;var o=r(158),c=function(){function t(t,e,r,i,n){void 0===i&&(i=!1),this.csvStringifier=t,this.append=i,this.fileWriter=n||new o.FileWriter(e,this.append,r)}return t.prototype.writeRecords=function(t){return i(this,void 0,void 0,(function(){var e,r;return n(this,(function(i){switch(i.label){case 0:return e=this.csvStringifier.stringifyRecords(t),r=this.headerString+e,[4,this.fileWriter.write(r)];case 1:return i.sent(),this.append=!0,[2]}}))}))},Object.defineProperty(t.prototype,"headerString",{get:function(){return!this.append&&this.csvStringifier.getHeaderString()||""},enumerable:!1,configurable:!0}),t}();e.CsvWriter=c},99:function(t,e){"use strict";var r,i=this&&this.__extends||(r=function(t,e){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},r(t,e)},function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function i(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)});Object.defineProperty(e,"__esModule",{value:!0}),e.FieldStringifier=e.VALID_FIELD_DELIMITERS=e.DEFAULT_FIELD_DELIMITER=void 0,e.createFieldStringifier=function(t,r,i,n){return void 0===t&&(t=e.DEFAULT_FIELD_DELIMITER),void 0===r&&(r=!1),void 0===i&&(i=!1),void 0===n&&(n=function(t){return t}),function(t){if(-1===e.VALID_FIELD_DELIMITERS.indexOf(t))throw new Error("Invalid field delimiter `".concat(t,"` is specified"))}(t),r?new c(t,i,n):new o(t,i,n)},e.DEFAULT_FIELD_DELIMITER=",",e.VALID_FIELD_DELIMITERS=[e.DEFAULT_FIELD_DELIMITER,";","|","\t"];var n=function(){function t(t,e,r){void 0===e&&(e=!1),void 0===r&&(r=function(t){return t}),this.fieldDelimiter=t,this.quoteEmptyFields=e,this.filterFunction=r}return t.prototype.isEmpty=function(t){return null==t||""===t},t.prototype.quoteField=function(t){return'"'.concat(t.replace(/"/g,'""'),'"')},t.prototype.filterChars=function(t){return this.filterFunction(t)},t}();e.FieldStringifier=n;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stringify=function(t){if(this.isEmpty(t))return this.quoteEmptyFields?'""':"";var e=String(t);return e=this.filterChars(e),this.needsQuote(e)?this.quoteField(e):e},e.prototype.needsQuote=function(t){return t.includes(this.fieldDelimiter)||t.includes("\r")||t.includes("\n")||t.includes('"')},e}(n),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.stringify=function(t){if(this.isEmpty(t))return this.quoteEmptyFields?'""':"";var e=String(t);return e=this.filterChars(e),this.quoteField(e)},e}(n)},158:function(t,e,r){"use strict";var i=this&&this.__awaiter||function(t,e,r,i){return new(r||(r=Promise))((function(n,o){function c(t){try{s(i.next(t))}catch(t){o(t)}}function u(t){try{s(i.throw(t))}catch(t){o(t)}}function s(t){var e;t.done?n(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(c,u)}s((i=i.apply(t,e||[])).next())}))},n=this&&this.__generator||function(t,e){var r,i,n,o,c={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function u(u){return function(s){return function(u){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,u[0]&&(c=0)),c;)try{if(r=1,i&&(n=2&u[0]?i.return:u[0]?i.throw||((n=i.return)&&n.call(i),0):i.next)&&!(n=n.call(i,u[1])).done)return n;switch(i=0,n&&(u=[2&u[0],n.value]),u[0]){case 0:case 1:n=u;break;case 4:return c.label++,{value:u[1],done:!1};case 5:c.label++,i=u[1],u=[0];continue;case 7:u=c.ops.pop(),c.trys.pop();continue;default:if(!((n=(n=c.trys).length>0&&n[n.length-1])||6!==u[0]&&2!==u[0])){c=0;continue}if(3===u[0]&&(!n||u[1]>n[0]&&u[1]<n[3])){c.label=u[1];break}if(6===u[0]&&c.label<n[1]){c.label=n[1],n=u;break}if(n&&c.label<n[2]){c.label=n[2],c.ops.push(u);break}n[2]&&c.ops.pop(),c.trys.pop();continue}u=e.call(t,c)}catch(t){u=[6,t],i=0}finally{r=n=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,s])}}};Object.defineProperty(e,"__esModule",{value:!0}),e.FileWriter=void 0;var o=r(540),c=r(591),u=(0,o.promisify)(c.writeFile),s=function(){function t(t,e,r){void 0===r&&(r="utf8"),this.path=t,this.append=e,this.encoding=r}return t.prototype.write=function(t){return i(this,void 0,void 0,(function(){return n(this,(function(e){switch(e.label){case 0:return[4,u(this.path,t,this.getWriteOption())];case 1:return e.sent(),this.append=!0,[2]}}))}))},t.prototype.getWriteOption=function(){return{encoding:this.encoding,flag:this.append?"a":"w"}},t}();e.FileWriter=s},218:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isObject=void 0,e.isObject=function(t){return"[object Object]"===Object.prototype.toString.call(t)}},540:function(t,e){"use strict";var r=this&&this.__spreadArray||function(t,e,r){if(r||2===arguments.length)for(var i,n=0,o=e.length;n<o;n++)!i&&n in e||(i||(i=Array.prototype.slice.call(e,0,n)),i[n]=e[n]);return t.concat(i||Array.prototype.slice.call(e))};Object.defineProperty(e,"__esModule",{value:!0}),e.promisify=function(t){return function(){for(var e=[],i=0;i<arguments.length;i++)e[i]=arguments[i];return new Promise((function(i,n){t.apply(null,r(r([],e,!0),[function(t,e){t?n(t):i(e)}],!1))}))}}},591:()=>{}},e={};function r(i){var n=e[i];if(void 0!==n)return n.exports;var o=e[i]={exports:{}};return t[i].call(o.exports,o,o.exports,r),o.exports}var i={};(()=>{"use strict";var t=i;Object.defineProperty(t,"__esModule",{value:!0}),t.createObjectCsvWriter=t.createArrayCsvWriter=t.createObjectCsvStringifier=t.createArrayCsvStringifier=void 0;var e=r(836),n=r(49),o=new e.CsvStringifierFactory,c=new n.CsvWriterFactory(o);t.createArrayCsvStringifier=function(t){return o.createArrayCsvStringifier(t)},t.createObjectCsvStringifier=function(t){return o.createObjectCsvStringifier(t)},t.createArrayCsvWriter=function(t){return c.createArrayCsvWriter(t)},t.createObjectCsvWriter=function(t){return c.createObjectCsvWriter(t)}})(),CsvWriter=i})();
//# sourceMappingURL=bundle.js.map